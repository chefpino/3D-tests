<!DOCTYPE html>
<html>

<body>
<table>
  <tr>
    <td><canvas id="myCanvas" width="800" height="500" style="border:1px solid"></canvas></td>
    <td>
        <div id="a"></div><br>
        <div id="b"></div><br>
        <div id="c"></div><br>
        <div id="d"></div><br>
    </td>
</tr>
</table>
<script>



const canvas = document.getElementById("myCanvas");
const cW=canvas.clientWidth;
const cH=canvas.clientHeight;
const ctx = canvas.getContext("2d"); 

const x0=-3;
const x1=3;
const y0=-3;
const y1=3;
const z0=-1;
const z1=10;

function g(x,y) {
  //return Math.cos(x+y);  
  //return x;
  //return x*x-.3*y*y;
  return 1;
}

//--------------
//graphic mapping paramenters (linear transformation of the given intervals to the canvas rect)
const a=-1*(1/4)*cW/(x1-x0);
const b=(1/4)*cW/(y1-y0);
const c=-1*(1/4)*cH/(x1-x0);
const d=-1*(1/4)*cH/(y1-y0);
const f=cH/(z1-z0); //factor for scaling z values

//====================================================
function mapToCanvas(x,y,z){
  //this maps the origin into the middle of the canvas, also flips
  //mx,my maps the original domain to the floor of the function
  //mz, projects the 
  return {mx: a*(x-x0)+b*(y-y0)+cW/2,
          my: cH/2-(c*(x-x0)+d*(y-y0)),
          mz: cH/2-(c*(x-x0)+d*(y-y0))-((z-z0)*f)
        }
  
}
//====================================================



//-------------------------------------------
function plot(x,y) {
  ctx.beginPath();
  ctx.fillStyle = "#FF0000";
  ctx.fillRect(x,y,2,2);
}
//-------------------------------------------
function drawXYZAxis() {  
  ctx.strokeStyle = "#D3D3D3"; 
  //Z axis
  ctx.moveTo(cW/2,cH/2);
  ctx.lineTo(cW/2,0);
  ctx.stroke();
  //X axis
  ctx.moveTo(cW/2,cH/2);
  ctx.lineTo(0,cH);
  ctx.stroke();
  //Y axis
  ctx.moveTo(cW/2,cH/2);
  ctx.lineTo(cW,cH);
  ctx.stroke(); 
 
};

function mapLine(xo,yo,xe,ye) {
  
  ctx.beginPath();
  ctx.moveTo(mapToCanvas(xo,yo).mx,mapToCanvas(xo,yo).my);
  ctx.lineTo(mapToCanvas(xe,ye).mx,mapToCanvas(xe,ye).my);
  ctx.strokeStyle = "#D3D3D3";
  ctx.stroke();  
}
//-------------------------------------------------  
function drawPavement(n) {
  
  const dx=(x1-x0)/n;
  const dy=(y1-y0)/n;

  for (let index = 0; index < n+1; index++) {
    
    mapLine(x0+index*dx,y0,x0+index*dx,y1);
    mapLine(x0,y0+index*dy,x1,y0+index*dy);
    
  }
}
//-----------------------------------------------

function testVerticalLines(x,y) {
  
  ctx.beginPath();
  ctx.moveTo(mapToCanvas(x,y).mx,mapToCanvas(x,y).my);
  ctx.lineTo(mapToCanvas(x,y,g(x,y)).mx,mapToCanvas(x,y,g(x,y)).mz);
  ctx.strokeStyle = "#000000"; //"#D3D3D3";
  ctx.stroke();  
  
}
function drawColumns(n) {
  
  const dx=(x1-x0)/n;
  const dy=(y1-y0)/n;
  var ix=x0;
  var iy=y0;
  var i=0;
  var j=0;
  var strColor="#0000"

  for   (i = 0; i < n+1; i++) {
    for (j = 0; j < n+1; j++) {
      
      ix=x0+i*dx;
      iy=y0+j*dy;
      
      ctx.beginPath();
      //plot(mapToCanvas(ix,iy,0).mx,mapToCanvas(ix,iy,0).my);
      ctx.moveTo(mapToCanvas(ix,iy,0).mx,mapToCanvas(ix,iy,0).my);
      ctx.lineTo(mapToCanvas(ix,iy,g(ix,iy)).mx,mapToCanvas(ix,iy,g(ix,iy)).mz);
      ctx.strokeStyle = strColor+i+j;
      ctx.stroke();
      plot(mapToCanvas(ix,iy,0).mx,mapToCanvas(ix,iy,g(ix,iy)).mz);
      
      
    }
  }
}
//-------------------------------
function plotFunction(n) {

  const dx=(x1-x0)/n;
  const dy=(y1-y0)/n;
  var ix=x0;
  var iy=y0;
  var i=0;
  var j=0;
  
  
  ctx.beginPath();
  ctx.strokeStyle = "#D3D3D3";


  for   (i = 0; i < n+1; i++) {    
    ix=x0+i*dx;
    for (j = 0; j < n; j++) {      
      iy=y0+j*dy;      
      ctx.moveTo(mapToCanvas(ix,iy,g(ix,iy)).mx,mapToCanvas(ix,iy,g(ix,iy)).mz);
      ctx.lineTo(mapToCanvas(ix,iy+dy,g(ix,iy+dy)).mx,mapToCanvas(ix,iy+dy,g(ix,iy+dy)).mz);
      ctx.stroke();
    }
  }

  for (j = 0; j < n+1; j++){
     iy=y0+j*dy;
     for (i = 0; i < n; i++) {               
          ix=x0+i*dx;      
          ctx.moveTo(mapToCanvas(ix,iy,g(ix,iy)).mx,mapToCanvas(ix,iy,g(ix,iy)).mz);
          ctx.lineTo(mapToCanvas(ix+dx,iy,g(ix+dx,iy)).mx,mapToCanvas(ix+dx,iy,g(ix+dx,iy)).mz);
          ctx.stroke();
    }
  }




  
}











//drawXYZAxis();
drawPavement(10);
plot(mapToCanvas(0,0,0).mx,mapToCanvas(0,0,0).my);
//testVerticalLines(.1,.4);
//drawColumns(50);
plotFunction(1);


//plot(xMap(2),yMap(2));
//console.log("wtf");
//console.log("wtf="+tempMap(R,P,1,1).xt);
//plot(mapToCanvas(0.3,0.5).mx,mapToCanvas(0.3,0.5).my);
//plot(mapToCanvas(0.3,0.5,1).mx,mapToCanvas(0.3,0.5,1).mz);




plot(mapToCanvas(0,0,1).mx,mapToCanvas(0,0,1).my);

//plot(mapToCanvas(x1,y1).mx,mapToCanvas(x1,y1).my);
//plot(mapToCanvas(x1,0).mx,mapToCanvas(x1,0).my);
//plot(mapToCanvas(0,y1).mx,mapToCanvas(0,y1).my);
//ctx.translate(0.5, 0.5);
//mapLine(0,0,x1,y1);

</script> 

</body>
</html>