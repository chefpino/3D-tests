<!DOCTYPE html>
<html> 
  <head>
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
    <script src="../../navigation/menu.js"></script>
    <script src="../../navigation/controls.js"></script>
    <script src="../../pages-data/tree.data.js"></script>
    <script src="fractals.tree.functions.js"></script>
      </head>
<body onload="init();">
<table border="0">
  <tr>
    <td valign="top">
      <div id="menu" ></div>
      <hr>
      <div id="content"></div>
      <hr>
  <div id="dynamicSliders"></div>
    </td>
    <td valign=top><canvas id="myCanvas" width="1000" height="700" style="border:1px solid">loading...</canvas></td>
  </tr>  
</table>

<script>
//--- global PARAMETERS ------------------------------------------------------------------  
const myCanvas = document.getElementById("myCanvas");
const ctx = myCanvas.getContext("2d"); 
const cW=myCanvas.clientWidth;
const cH=myCanvas.clientHeight;
const pi=Math.PI;

//--- defined to be global, actual values taken from the ext. file data.js
var initAngle=0;       
var dAngle=0;          
var initLen=0;         
var minLen=0;          
var reduction=0;       
var initTrunk=0;       
var trunkReduction=0;   
var minBranch=0;       
var nTrees=1;
//----------------------------------------------------------------------------------------
//-------------------- INIT---------------------------
function init(){

    genNavigation("tree",false); //navigation menu

    ctx.shadowBlur = 5;
    ctx.shadowColor = "green";
    
    generateControls();
    fileToParameters(); //initiate event listener for file uploader
    loadvaluesandgo();
  }  
//-----------------------------------------------------------------------
function loadvaluesandgo() {

//go! button

// -- load parameters from params object
    initAngle=params["initAngle"].val;          
    dAngle=params["dAngle"].val;            
    initLen=params["initLen"].val;       
    minLen=params["minLen"].val;  
    reduction=params["reduction"].val;       
    initTrunk=params["initTrunk"].val;       
    trunkReduction=params["trunkReduction"].val;    
    minBranch=params["minBranch"].val;  
    nTrees=1 * params.nTrees.val;

  //---clear canvas
  ctx.clearRect(0, 0, cW, cH);  

  //--- draw trees
  for (let index = 1; index <= nTrees; index++) {    
    draw(cW/(nTrees+1)*index-cW/2,0,initAngle,initLen,initTrunk);    
  }
  
}
//--------------------------------------------------
function resetReload() {
  location.reload();  
}

</script> 
</body>
</html>
